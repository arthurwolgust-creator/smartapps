<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calculateur – Coût du reporting manuel (MyReport)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style> body { background: #f5f7fb; } </style>
</head>
<body>
  <div class="mx-auto max-w-3xl p-6 lg:p-8">
    <div class="mb-6 rounded-2xl bg-white p-5 shadow-sm ring-1 ring-[#0075F2]/15">
      <div class="flex items-center gap-3">
        <div class="flex h-12 w-12 items-center justify-center rounded-2xl" style="background-color:#0075F21A">
          <span class="text-xl" style="color:#0075F2">∑</span>
        </div>
        <div class="flex-1">
          <h1 class="text-2xl font-semibold text-gray-900">Calculateur – Coût du reporting manuel</h1>
          <p class="text-sm text-gray-600">Variables minimales, résultats clairs.</p>
        </div>
      </div>
    </div>

    <div id="app"></div>
  </div>

  <!-- React + ReactDOM UMD (production) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <script>
    (function(){
      const { useState, useMemo } = React;

      // ===== Utils =====
      const eur = (n) => n.toLocaleString("fr-FR", { style: "currency", currency: "EUR", maximumFractionDigits: 0 });

      function NumberInput({ value, onChange, step = 1, min = 0, suffix, className }) {
        return React.createElement(
          "div", { className: "relative " + (className || "") },
          React.createElement("input", {
            type: "number",
            value: Number.isFinite(value) ? value : 0,
            min, step,
            onChange: (e) => onChange(parseFloat(e.target.value || "0")),
            className: "w-full rounded-2xl border border-gray-200 bg-white p-3 pr-16 text-sm font-medium text-gray-900 shadow-sm focus:outline-none focus:ring-2 focus:ring-[#0075F2] placeholder:text-gray-400"
          }),
          suffix ? React.createElement("span", { className: "pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-500" }, suffix) : null
        );
      }
      const Label = ({ children }) =>
        React.createElement("div", { className: "flex items-center gap-2 text-sm font-medium text-gray-800" }, children);

      // ===== Constants & defaults =====
      const HOURLY_COST = 60; // € / h — hypothèse coût horaire moyen chargé
      const REPORT_TYPES = ["Reporting financier","Reporting comptable","Reporting commercial","Reporting Marketing","Reporting RH","Autre"];
      const STEP_LABELS = [
        "Collecte des données (localiser + export)",
        "Retraitement & consolidation dans Excel",
        "Mise en forme du reporting (tableau + graphiques)"
      ];
      const TYPE_PRESETS = {
        "Reporting financier": [3,6,3],
        "Reporting comptable": [4,8,4],
        "Reporting commercial": [2,4,2],
        "Reporting Marketing": [2,3,3],
        "Reporting RH": [2,5,3],
        "Autre": [2,4,2]
      };

      function App() {
        const [type, setType] = useState("Reporting financier");
        const [recurrence, setRecurrence] = useState(12); // nb / an
        const [people, setPeople] = useState(1);
        const [stepHours, setStepHours] = useState(TYPE_PRESETS[type]); // heures / report / personne

        const onTypeChange = (next) => { setType(next); setStepHours(TYPE_PRESETS[next] || TYPE_PRESETS["Autre"]); };
        const updateStep = (idx, v) => setStepHours((prev) => { const a = prev.slice(); a[idx] = Math.max(0, v); return a; });

        const computed = useMemo(() => {
          const hoursPerReportPerPerson = stepHours.reduce((a, h) => a + h, 0);
          const teamHoursPerReport = hoursPerReportPerPerson * people;
          const costPerReport = teamHoursPerReport * HOURLY_COST;
          const annualHours = teamHoursPerReport * recurrence;
          const annualCost = costPerReport * recurrence;
          const monthlyAvgCost = annualCost / 12;
          return { hoursPerReportPerPerson, teamHoursPerReport, costPerReport, annualHours, annualCost, monthlyAvgCost };
        }, [stepHours, people, recurrence]);

        const copySummary = () => {
          const lines = [];
          lines.push("Calcul du coût du reporting manuel – Vue simple", "");
          lines.push(`Type de reporting: ${type}`);
          lines.push(`Récurrence / an: ${recurrence}`);
          lines.push(`Personnes impliquées: ${people}`);
          lines.push(`Hypothèse coût horaire chargé: ${HOURLY_COST} €/h`, "");
          STEP_LABELS.forEach((lab, i) => lines.push(`• ${lab}: ${stepHours[i]} h / report (par personne)`));
          lines.push("", `Heures / report – par personne: ${computed.hoursPerReportPerPerson.toFixed(1)} h`);
          lines.push(`Heures / report – équipe: ${computed.teamHoursPerReport.toFixed(1)} h`);
          lines.push(`Coût / report: ${eur(computed.costPerReport)}`);
          lines.push(`Heures / an: ${computed.annualHours.toFixed(1)} h`);
          lines.push(`Coût / an: ${eur(computed.annualCost)}`);
          lines.push(`Coût moyen / mois: ${eur(computed.monthlyAvgCost)}`);
          navigator.clipboard.writeText(lines.join("\n"));
          alert("Résumé copié dans le presse-papiers ✅");
        };

        return React.createElement(React.Fragment, null,
          // Carte variables
          React.createElement("div", { className: "mb-6 rounded-2xl bg-white p-5 shadow-sm ring-1 ring-[#0075F2]/15" },
            React.createElement("div", { className: "mb-3 text-sm font-semibold text-gray-900" }, "Variables"),
            React.createElement("div", { className: "grid grid-cols-1 gap-3 sm:grid-cols-2" },
              React.createElement("div", { className: "sm:col-span-2" },
                React.createElement(Label, null, "Type de reporting"),
                React.createElement("select", {
                  value: type, onChange: (e) => onTypeChange(e.target.value),
                  className: "mt-2 w-full rounded-2xl border border-gray-200 bg-white p-3 text-sm font-medium text-gray-900 shadow-sm focus:outline-none focus:ring-2 focus:ring-[#0075F2]"
                }, REPORT_TYPES.map((opt) => React.createElement("option", { key: opt, value: opt }, opt)))
              ),
              React.createElement("div", null,
                React.createElement(Label, null, "Récurrence par an"),
                React.createElement(NumberInput, { value: recurrence, onChange: setRecurrence, step: 1, suffix: "/an" })
              ),
              React.createElement("div", null,
                React.createElement(Label, null, "Personnes impliquées"),
                React.createElement(NumberInput, { value: people, onChange: setPeople, step: 1, suffix: "pers" })
              )
            ),
            React.createElement("div", { className: "mt-4" },
              React.createElement("div", { className: "mb-2 text-sm font-semibold text-gray-900" }, "Étapes du reporting (heures par report et par personne)"),
              React.createElement("div", { className: "grid grid-cols-12 items-end gap-3 text-xs font-medium text-gray-500" },
                React.createElement("div", { className: "col-span-7" }, "Étape"),
                React.createElement("div", { className: "col-span-5" }, "Heures / report ", React.createElement("span", { className: "text-gray-400" }, "(par pers)"))
              ),
              STEP_LABELS.map((lab, i) => React.createElement("div", { key: i, className: "mt-2 grid grid-cols-12 items-center gap-3" },
                React.createElement("div", { className: "col-span-7 text-sm text-gray-800" }, lab),
                React.createElement(NumberInput, { value: stepHours[i], onChange: (v) => updateStep(i, v), step: 0.5, suffix: "h", className: "col-span-5" })
              )),
              React.createElement("div", { className: "mt-3 rounded-xl p-3 text-xs", style: { backgroundColor: "#F7F9FC" } },
                "Hypothèse utilisée pour le calcul : ", React.createElement("b", null, `${HOURLY_COST} €/h`), " (coût horaire moyen chargé)."
              )
            )
          ),
          // Carte résultats
          React.createElement("div", { className: "rounded-2xl bg-white p-5 shadow-sm ring-1 ring-gray-100" },
            React.createElement("div", { className: "mb-3 text-sm font-semibold text-gray-900" }, "Résultats"),
            React.createElement("div", { className: "grid grid-cols-1 gap-3 sm:grid-cols-2" },
              React.createElement("div", { className: "rounded-xl p-3", style: { backgroundColor: "#F7F9FC" } },
                React.createElement("div", { className: "text-xs text-gray-600" }, "Heures / report – par personne"),
                React.createElement("div", { className: "mt-1 text-xl font-semibold text-gray-900" }, `${computed.hoursPerReportPerPerson.toFixed(1)} h`)
              ),
              React.createElement("div", { className: "rounded-xl p-3", style: { backgroundColor: "#F7F9FC" } },
                React.createElement("div", { className: "text-xs text-gray-600" }, "Heures / report – équipe"),
                React.createElement("div", { className: "mt-1 text-xl font-semibold text-gray-900" }, `${computed.teamHoursPerReport.toFixed(1)} h`)
              ),
              React.createElement("div", { className: "rounded-xl p-3", style: { backgroundColor: "#F7F9FC" } },
                React.createElement("div", { className: "text-xs text-gray-600" }, "Coût / report"),
                React.createElement("div", { className: "mt-1 text-xl font-semibold text-gray-900" }, eur(computed.costPerReport))
              ),
              React.createElement("div", { className: "rounded-xl p-3", style: { backgroundColor: "#F7F9FC" } },
                React.createElement("div", { className: "text-xs text-gray-600" }, "Heures / an"),
                React.createElement("div", { className: "mt-1 text-xl font-semibold text-gray-900" }, `${computed.annualHours.toFixed(1)} h`)
              ),
              React.createElement("div", { className: "rounded-xl p-3", style: { backgroundColor: "#F7F9FC" } },
                React.createElement("div", { className: "text-xs text-gray-600" }, "Coût / an"),
                React.createElement("div", { className: "mt-1 text-xl font-semibold text-gray-900" }, eur(computed.annualCost))
              ),
              React.createElement("div", { className: "rounded-xl p-3", style: { backgroundColor: "#F7F9FC" } },
                React.createElement("div", { className: "text-xs text-gray-600" }, "Coût moyen / mois"),
                React.createElement("div", { className: "mt-1 text-xl font-semibold text-gray-900" }, eur(computed.monthlyAvgCost))
              )
            ),
            React.createElement("div", { className: "mt-4" },
              React.createElement("button", {
                onClick: copySummary,
                className: "inline-flex items-center gap-2 rounded-xl bg-[#0075F2] px-4 py-2 text-sm font-medium text-white shadow-sm hover:brightness-110"
              }, "Copier le résumé")
            )
          )
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("app"));
      root.render(React.createElement(App));
    })();
  </script>
</body>
</html>
